<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üçî Rotiser√≠a En Boca de Todos ‚Äì Guaymall√©n, Mendoza</title>
  <link rel="icon" type="image/png" href="images/favicon-32x32.png" />
  <style>
    :root {
      font-family: sans-serif;
    }
    body {
      margin: 0;
      padding: 1rem;
      background: url('images/background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #333;
      position: relative;
      overflow-x: hidden;
    }
    /* RGB suave sobre el fondo, con blend para que se vea la imagen */
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      background: linear-gradient(270deg,
        #ff0000, #00ff00, #0000ff, #ff0000);
      background-size: 600% 600%;
      animation: rgbShift 20s ease infinite;
      mix-blend-mode: screen;
      opacity: 0.15;
      z-index: -1;
    }
    @keyframes rgbShift {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    .wrap {
      max-width: 700px;
      margin: auto;
      background: rgba(255 255 255 / 0.95);
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
      padding: 1rem;
    }

  .banner-image {
  width: 100%;
  height: auto;
  object-fit: contain; /* Cambiado para que la imagen se vea completa */
  border-radius: 12px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  transition: transform 0.3s ease;
  cursor: pointer;
  background: #fff; /* Fondo blanco para evitar transparencias */
}

    .banner-image:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }

    h1 {
      margin: 0 0 1rem;
      text-align: center;
      font-size: 1.8rem;
      color: #d62828;
      font-weight: 900;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    /* Navbar botones tipo pesta√±a para filtrar carrusel */
    .navbar {
      display: flex;
      justify-content: center;
      margin-bottom: 1rem;
      gap: 1rem;
    }
    .navbar button {
      background: #ffcc00;
      border: none;
      padding: 0.5rem 1rem;
      font-weight: bold;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;
    }
    .navbar button.active,
    .navbar button:hover {
      background: #d62828;
      color: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    /* Carrusel */
    .carousel {
      display: flex;
      overflow-x: auto;
      scroll-behavior: smooth;
      gap: 1rem;
      padding-bottom: 1rem;
    }
    .carousel::-webkit-scrollbar {
      height: 8px;
    }
    .carousel::-webkit-scrollbar-thumb {
      background: #d62828;
      border-radius: 4px;
    }
    .producto {
      flex: 0 0 180px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      padding: 0.5rem;
      user-select: none;
    }
    .producto-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .producto img {
      width: 160px;
      height: 140px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 0.5rem;
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .producto img:hover {
      transform: scale(1.05);
      z-index: 10;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    .info {
      text-align: center;
      margin-bottom: 0.5rem;
      font-weight: 600;
      font-size: 1rem;
    }
    .qty {
      width: 60px;
      margin-bottom: 0.5rem;
      text-align: center;
      font-weight: 700;
      border-radius: 6px;
      border: 1px solid #ccc;
      padding: 0.25rem;
    }
    .aderezo input {
      width: 100%;
      border-radius: 6px;
      border: 1px solid #ccc;
      padding: 0.25rem;
      font-size: 0.9rem;
    }

    label {
      font-size: 0.9rem;
      margin-bottom: 0.25rem;
      display: block;
    }

    button#btnEnviar {
      background: #ffcc00;
      color: #000;
      border: none;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      width: 100%;
      margin-top: 1rem;
    }
    button#btnEnviar:disabled {
      background: #aaa;
      cursor: not-allowed;
    }

    .total {
      font-size: 1.2rem;
      font-weight: bold;
      margin-top: 1rem;
      text-align: right;
    }

    .footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      text-align: center;
      color: #666;
    }

    /* Ticket */
    #ticket {
      display: none;
      margin-top: 2rem;
      background: #fff;
      padding: 1rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    #ticket h2 {
      text-align: center;
      color: #d62828;
    }
    #contenidoTicket {
      white-space: pre-wrap;
      font-size: 0.95rem;
      margin-bottom: 1rem;
    }
    #ticket button {
      margin-right: 0.5rem;
      margin-top: 0.5rem;
    }

    /* Form inputs */
    input[type="number"], input[type="text"], input[type="tel"] {
      width: 100%;
      padding: 0.4rem 0.5rem;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <img src="images/imagen body.jpg" alt="Banner" class="banner-image" />
    <h1>Hac√© tu pedido</h1>

    <!-- Navbar para filtrar -->
    <div class="navbar">
      <button class="filter-btn active" data-category="todos">Todos</button>
      <button class="filter-btn" data-category="hamburguesas">Hamburguesas</button>
      <button class="filter-btn" data-category="papas">Papas</button>
      <button class="filter-btn" data-category="panchos">Panchos</button>
      <button class="filter-btn" data-category="pizzas">Pizzas</button>
    </div>

    <!-- Carrusel de productos -->
    <div class="carousel" id="carouselProductos"></div>

    <form id="formPedido">
      <label>
        <input type="radio" name="tipoEntrega" value="retiro" id="retiro" checked />
        Retiro en local (sin env√≠o)
      </label>
      <label>
        <input type="radio" name="tipoEntrega" value="envio" id="envio" />
        Con env√≠o hasta 1 km (+$<span id="precioEnvio"></span>). M√°s de 1 km: $500 por km adicional
      </label>

      <label>Distancia estimada en km (solo si es m√°s de 1 km)
        <input type="number" id="distanciaExtra" min="0" step="0.1" placeholder="Ej: 2" disabled />
      </label>

      <label>Tu tel√©fono
        <input type="tel" id="telCliente" required placeholder="2616224435" />
      </label>
      <label>Direcci√≥n
        <input type="text" id="dirCliente" placeholder="Barrio San Javier‚Ä¶" disabled />
      </label>

      <p class="total">Total: $<span id="txtTotal">0</span></p>
      <button type="submit" id="btnEnviar" disabled>Enviar por WhatsApp</button>
    </form>

    <!-- üßæ Ticket -->
    <div id="ticket">
      <h2>üßæ Tu comprobante</h2>
      <pre id="contenidoTicket"></pre>
      <button onclick="copiarTicket()">üìã Copiar resumen</button>
      <button onclick="descargarTicketPDF()">‚¨áÔ∏è Descargar PDF</button>
    </div>

    <div class="footer">
      <p><strong>Rotiser√≠a "En Boca de Todos"</strong></p>
      <p>üìç Barrio San Javier, Manzana Q, Casa 17 ‚Äì Mendoza</p>
      <p>üìû Tels: 261 622‚Äë4435 / 261 634‚Äë5099 / 261 503‚Äë8515</p>
      <p>üåê <a href="https://enbocadetod0s.netlify.app" target="_blank">enbocadetod0s.netlify.app</a></p>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const numeroWhatsApp = '5492616224435';
    const costoEnvio = 500;

    // Productos con categor√≠a para filtrar
    const productos = [
      { id: 1, nombre: 'Chesse Burguer', precio: 4800, foto: 'images/chesseburguer.jpg', categoria: 'hamburguesas' },
      { id: 2, nombre: 'Cono de papas', precio: 2400, foto: 'images/Cono-papas.jpg', categoria: 'papas' },
      { id: 3, nombre: 'Fugazzeta', precio: 7800, foto: 'images/fugazzeta.jpg', categoria: 'pizzas' },
      { id: 4, nombre: 'Hamburguesa mediana + guarnici√≥n', precio: 7800, foto: 'images/Hamburgesamediana-guarnicion.jpg', categoria: 'hamburguesas' },
      { id: 5, nombre: 'Hamburguesa completa', precio: 11000, foto: 'images/Hamburguesacompleta.jpg', categoria: 'hamburguesas' },
      { id: 6, nombre: 'Pancho con poncho', precio: 2700, foto: 'images/panchoconponcho.jpg', categoria: 'panchos' },
      { id: 7, nombre: 'Panchos + lluvia de papas', precio: 2000, foto: 'images/panchoslluviapapas.jpg', categoria: 'panchos' },
      { id: 8, nombre: 'Papas chicas', precio: 4000, foto: 'images/papas-chicas.jpg', categoria: 'papas' },
      { id: 9, nombre: 'Papas a caballo', precio: 6000, foto: 'images/papasacaballo.jpg', categoria: 'papas' },
      { id: 10, nombre: 'Papas grandes', precio: 5000, foto: 'images/papasgrandes.jpg', categoria: 'papas' },
      { id: 11, nombre: 'Pizza especial', precio: 7800, foto: 'images/pizza-especial.jpg', categoria: 'pizzas' }
    ];

    const precioEnvioSpan = document.getElementById('precioEnvio');
    precioEnvioSpan.textContent = costoEnvio;

    const carousel = document.getElementById('carouselProductos');
    const retiroRadio = document.getElementById('retiro');
    const envioRadio = document.getElementById('envio');
    const distanciaExtra = document.getElementById('distanciaExtra');
    const dirCliente = document.getElementById('dirCliente');
    const totalSpan = document.getElementById('txtTotal');
    const btnEnviar = document.getElementById('btnEnviar');

    // Render productos en carrusel, con inputs qty y aderezos
    function renderProductos(filtro = 'todos') {
      carousel.innerHTML = '';
      const prodsFiltrados = filtro === 'todos' ? productos : productos.filter(p => p.categoria === filtro);
      prodsFiltrados.forEach(p => {
        const div = document.createElement('div');
        div.className = 'producto';
        div.dataset.id = p.id;
        div.innerHTML = `
          <div class="producto-inner">
            <img src="${p.foto}" alt="${p.nombre}">
            <div class="info">
              <strong>${p.nombre}</strong><br>$${p.precio}
            </div>
            <input type="number" min="0" value="0" data-id="${p.id}" class="qty" />
            <label class="aderezo">Aderezos:
              <input type="text" placeholder="Ej: mayonesa, ketchup" data-aderezo-id="${p.id}" />
            </label>
          </div>
        `;
        carousel.appendChild(div);
      });
    }

    renderProductos();

    // Filtros navbar
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderProductos(btn.dataset.category);
        calcularTotal();
      });
    });

    function actualizarCamposEntrega() {
      if (envioRadio.checked) {
        distanciaExtra.disabled = false;
        dirCliente.disabled = false;
        dirCliente.required = true;
      } else {
        distanciaExtra.disabled = true;
        distanciaExtra.value = '';
        dirCliente.disabled = true;
        dirCliente.value = '';
        dirCliente.required = false;
      }
      calcularTotal();
    }

    retiroRadio.addEventListener('change', actualizarCamposEntrega);
    envioRadio.addEventListener('change', actualizarCamposEntrega);

    function calcularTotal() {
      let total = 0;
      document.querySelectorAll('.qty').forEach(inp => {
        const cantidad = parseInt(inp.value) || 0;
        if (cantidad > 0) {
          const prod = productos.find(p => p.id == inp.dataset.id);
          total += cantidad * prod.precio;
        }
      });
      if (envioRadio.checked) {
        let extra = parseFloat(distanciaExtra.value) || 0;
        let envioTotal = costoEnvio;
        if (extra > 1) envioTotal += (Math.ceil(extra - 1)) * 500;
        total += envioTotal;
      }
      totalSpan.textContent = total;
      btnEnviar.disabled = total === 0;
      return total;
    }

    // Delegado para inputs qty y distancia
    document.body.addEventListener('input', e => {
      if (e.target.classList.contains('qty') || e.target === distanciaExtra) calcularTotal();
    });

    actualizarCamposEntrega();

    document.getElementById('formPedido').addEventListener('submit', e => {
      e.preventDefault();
      const tel = document.getElementById('telCliente').value.trim();
      const dir = dirCliente.value.trim();
      const detalles = [];

      document.querySelectorAll('.qty').forEach(inp => {
        const cantidad = parseInt(inp.value) || 0;
        if (cantidad > 0) {
          const prodId = inp.dataset.id;
          const prod = productos.find(p => p.id == prodId);
          const aderezoInput = document.querySelector(`[data-aderezo-id="${prodId}"]`);
          const aderezos = aderezoInput?.value.trim();
          const conAderezo = aderezos ? ` (${aderezos})` : '';
          detalles.push(`${cantidad} x ${prod.nombre}${conAderezo}`);
        }
      });

      if (detalles.length === 0) {
        alert('Agreg√° al menos un producto al pedido.');
        return;
      }

      if (envioRadio.checked && dir === '') {
        alert('Por favor, complet√° la direcci√≥n para env√≠o.');
        dirCliente.focus();
        return;
      }

      let mensaje = `Hola! Quiero pedir: ${detalles.join(', ')}.`;
      if (envioRadio.checked) mensaje += ` Con env√≠o a ${dir}.`;
      else mensaje += ' Retiro en el local.';
      mensaje += ` Total $${calcularTotal()}. Mi tel√©fono: ${tel}.`;

      const url = `https://api.whatsapp.com/send?phone=${numeroWhatsApp}&text=${encodeURIComponent(mensaje)}`;
      window.open(url, '_blank');
      mostrarTicket(mensaje);

      setTimeout(() => {
        if (!document.hasFocus()) return;
        alert('Si WhatsApp no se abri√≥ autom√°ticamente, toc√° este enlace:\n\n' + url);
      }, 1500);
    });

    function mostrarTicket(mensaje) {
      const ticket = document.getElementById('ticket');
      const contenido = document.getElementById('contenidoTicket');
      const ahora = new Date().toLocaleString();
      contenido.textContent = `üßæ Comprobante de pedido\n${mensaje}\nFecha: ${ahora}\n\n¬°Gracias por elegirnos!`;
      ticket.style.display = 'block';
    }

    function copiarTicket() {
      const texto = document.getElementById('contenidoTicket').textContent;
      navigator.clipboard.writeText(texto).then(() => {
        alert('Resumen copiado al portapapeles üìã');
      });
    }

    // Descargar comprobante PDF con estilo y logo
    async function descargarTicketPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const logoImg = new Image();
      logoImg.src = 'images/favicon-32x32.png'; // Usa tu logo o cambia path
      await new Promise(resolve => {
        logoImg.onload = resolve;
      });

      // Fondo blanco
      doc.setFillColor(255, 255, 255);
      doc.rect(0, 0, doc.internal.pageSize.getWidth(), doc.internal.pageSize.getHeight(), 'F');

      // Logo
      doc.addImage(logoImg, 'PNG', 15, 10, 20, 20);

      doc.setFontSize(18);
      doc.setTextColor('#d62828');
      doc.text('Rotiser√≠a "En Boca de Todos"', 40, 20);

      doc.setFontSize(14);
      doc.setTextColor(0);
      const texto = document.getElementById('contenidoTicket').textContent;
      const lineas = doc.splitTextToSize(texto, 170);
      doc.text(lineas, 15, 45);

      doc.setFontSize(12);
      doc.setTextColor(100);
      doc.text('¬°Gracias por tu compra!', 105, doc.internal.pageSize.getHeight() - 20, { align: 'center' });

      doc.save('comprobante-pedido.pdf');
    }
  </script>
</body>
</html>
